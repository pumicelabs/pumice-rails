# frozen_string_literal: true

class <%= class_name %>Sanitizer < Pumice::Sanitizer
  sanitizes :<%= plural_file_name %>

<% if has_pii_columns? -%>
  # PII - scrub with fake data
<% pii_columns.each do |column| -%>
<% if defaults? -%>
  scrub(:<%= column.name %>) <%= scrub_logic_for(column) %>
<% else -%>
  scrub(:<%= column.name %>) { raise NotImplementedError }
<% end -%>
<% end -%>
<% end -%>
<% if has_credential_columns? -%>

  # Credentials - clear sensitive data
<% credential_columns.each do |column| -%>
<% if defaults? -%>
  scrub(:<%= column.name %>) { nil }
<% else -%>
  scrub(:<%= column.name %>) { raise NotImplementedError }
<% end -%>
<% end -%>
<% end -%>
<% if has_keep_columns? -%>

  # Non-PII - safe to keep
  keep <%= keep_columns.map { |c| ":#{c.name}" }.join(",\n       ") %>
<% end -%>
end
